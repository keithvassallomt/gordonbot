name: gordonbot
description: Developer tasks for GordonBot (backend FastAPI + Vite dashboard)

# Common dev tasks you can run with Codex CLI or as reference commands
tasks:
  setup:
    desc: Create backend venv and install backend/frontend deps
    run: bash scripts/bootstrap.sh

  dev:
    desc: Run backend (Uvicorn) and frontend (Vite) with a TUI supervisor
    run: bash scripts/dev.sh

  backend:dev:
    desc: Run FastAPI backend with auto-reload on port 8000
    run: uvicorn app.main:app --host 0.0.0.0 --port 8000 --reload
    cwd: gordonbot-backend
    env_files:
      - gordonbot-backend/.env

  backend:install:
    desc: Create/refresh backend venv and install requirements
    run: |
      python3 -m venv .venv && \
      . .venv/bin/activate && \
      python -m pip install --upgrade pip && \
      pip install -r requirements.txt
    cwd: gordonbot-backend

  frontend:dev:
    desc: Run Vite dev server on host (port 5173)
    run: npm run dev:host
    cwd: gordonbot-dashboard
    env_files:
      - gordonbot-dashboard/.env

  frontend:install:
    desc: Install dashboard dependencies with npm ci
    run: npm ci
    cwd: gordonbot-dashboard

  frontend:build:
    desc: Build dashboard (Vite)
    run: npm run build
    cwd: gordonbot-dashboard

  project:describe:
    desc: Print high-level architecture summary
    run: sed -n '1,240p' docs/ARCHITECTURE.md

  project:index:
    desc: Generate machine-readable index at .codex/scan.json
    run: python3 scripts/project_index.py > .codex/scan.json && echo 'Wrote .codex/scan.json'

  project:open:
    desc: Pretty-print the current .codex/scan.json
    run: python3 -c 'import json,sys; print(json.dumps(json.load(open(".codex/scan.json")), indent=2, sort_keys=True))'
